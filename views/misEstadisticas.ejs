
<h2>Mis Estadisticas</h2>

<h2>Vendedor: 
  <% if(user) {%>
      <span class="badge bg-success"> <%= user.nombre %></span>
      <%}%>
</h2>

<div  class="table-responsive">
  
  <table id="ventas" class="table table-bordered">
    <thead>
      <tr>
        <th scope="col" >Nombre del Vendedor</th>
        <th scope="col">Total de Ventas</th>
        <th scope="col">Total de Activas</th>
        <th scope="col">Total de No Entregadas</th>
        <th scope="col">Total de Pendientes</th>
        <th scope="col">Total de Rechazadas</th>
        <th scope="col">Proyeccion</th>
        <th scope="col">% de NO Activas</th>
        <th scope="col">% de Caidas</th>
        <th scope="col">% de Activacion</th>
        <th scope="col">Dias Transcurridos</th>
        <th scope="col">Dias Habiles</th>
      </tr>
    </thead>
    <tbody>
      <% rows.forEach((row) => {%>
        <tr>
          <td ><%= row[0] %></td>
          <td><%= row[1] %></td>
          <td><%= row[2] %></td>
          <td><%=row[3] %></td>
          <td><%=row[4] %></td>
          <td><%=row[5] %></td>
          <td><%=row[6] %></td>
          <td><%=row[7] %></td>
          <td><%=row[8] %></td>
          <td><%=row[9] %></td>
          <td><%=row[10] %></td>
          <td><%=row[11] %></td>
        </tr>
        <% });%> 
      
    </tbody>
    
    
  </table>

</div>

<br>
<a href="register" class="btn btn-outline-success">Registrar</a>

<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
      <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
      <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>

<script>
  $(document).ready(function () {
      var table = $('#ventas').DataTable({
      });
     
       // Encuentra el Ã­ndice de la columna "Nombre Vendedor"
var columnaNombreVendedor = table.column(0).index();

// Filtra la tabla por el valor de user.name en la columna "Nombre Vendedor"
table.column(columnaNombreVendedor).search("<%= user.nombre %>").draw();
   
});

  function confirmar(id){
    Swal.fire({
  title: 'Seguro que quiere borrar este usuario '+id+'?',
  text: "No se podra recuperar",
  icon: 'warning',
  showCancelButton: true,
  confirmButtonColor: '#3085d6',
  cancelButtonColor: '#d33',
  confirmButtonText: 'Confirmar'
}).then((result) => {
  if (result.isConfirmed) {
    Swal.fire(
      'Borrado!',
      'El usuario fue borrado correctamente',
      'success'
    )
    window.location = '/borrarUser/'+id;
  }
})
  }
</script>
